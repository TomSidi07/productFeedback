import e from"./CommentView.js";import t from"./DetailView.js";import o from"./RoadmapView.js";import s from"./SuggestionView.js";import n from"./createFeedbackView.js";let suugsestionMain=document.querySelector(".suggestion"),roadmapMain=document.querySelector(".roadmap"),suggestionCont=document.querySelector(".suggestion__content"),btn__addFeedback=document.querySelector(".btn--add-feedback"),btnCancel=document.querySelector(".btn--cancel"),btnaddFeedback=document.querySelector(".add-feedback"),IdCount,popup=document.querySelector(".popup"),categories=document.querySelectorAll(".btn--cat"),status=document.querySelectorAll(".btn--stat"),suggestionTotal=document.querySelector(".suggestion-total "),url="./data.json",collection=[],feedBacks;async function request(){try{await fetch(url||"").then(e=>e.json()).then(e=>{try{console.log("req"),IdCount=collection.length++,s.upDateUI(e.productRequests),localStorage.setItem("collection",JSON.stringify(e.productRequests)),e.productRequests.forEach(e=>{localStorage.getItem(e.id)||localStorage.setItem(e.id,JSON.stringify(e))}),feedBacks=document.querySelectorAll(".feedback");let t=document.querySelectorAll(".pan.uvoptes");console.log(t),t&&t.forEach(e=>{e.addEventListener("click",e=>{if(e.preventDefault(),e.target.classList.add("active"),e.target.classList.contains("active")){console.log("active");let t=JSON.parse(localStorage.getItem("currentObj")||"{}");t.upvotes+=1,localStorage.setItem(t.id,JSON.stringify(t)),localStorage.setItem("currentObj",JSON.stringify(t))}})}),s.setCurrent(feedBacks,collection),btn__addFeedback&&btn__addFeedback.addEventListener("click",e=>{document.querySelector(".add-feedback"),e.preventDefault(),popup&&popup.classList.toggle("active"),btnCancel&&btnCancel.addEventListener("click",t=>{e.preventDefault(),popup.classList.remove("active")})})}catch(o){console.log(o)}}).catch(e=>{console.log(e)})}catch(e){console.log(e)}}request();let UpdatedCollection=[];for(let i=0;i<localStorage.length;i++){let a=JSON.parse(localStorage.getItem(i));null!=a&&UpdatedCollection.push(a)}let prom=new Promise((e,t)=>{setTimeout(()=>{s.upDateUI(UpdatedCollection);let e=document.querySelectorAll(".feedback"),t=document.querySelectorAll(".card--roadmap "),o=document.querySelectorAll(".pan.upvotes");s.setCurrent(e,UpdatedCollection),s.setCurrentRoadMap(t,UpdatedCollection),s.showCurrentComments(),console.log(o),console.log("okey")},300)});for(let i=0;i<localStorage.length;i++)JSON.parse(localStorage.getItem(i))&&collection.push(JSON.parse(localStorage.getItem(i)));status.forEach(e=>{e.addEventListener("click",t=>{status.forEach(e=>{e.classList.remove("active"),t.target.classList.toggle("active")}),console.log(e),s.filterFeeds(collection,e.textContent.toLowerCase())})}),suggestionTotal&&(suggestionTotal.innerHTML=renderByStatus("suggestion").length),console.log(),0==collection.length&&(suggestionCont.innerHTML=`<div class="emptyFeedback">
      <img src="/src/assets/suggestions/illustration-empty.svg" alt="">
      <h2>There is no feedback yet</h2>
      <p>
        Got a suggestion? Found a bug that needs to be squashed? We love hearing
        about new ideas to improve our app.
      </p>
      <button class="btn suggestion__header__right btn--add-feedback">
        + Add Feedback
      </button>
    </div>`);class FeedBack{id;title;category;upvotes;status;comments;description;constructor(e,t=[],o,s,n=0,a){this.id=collection.length,this.comments=t,this.category=s,this.description=o,this.status=a,this.title=e,this.upvotes=n}}function cleanSuggestCont(){(suggestionCont||"").innerHTML=""}function createFeedback(){let{title:e,category:t,description:o}=n,s=new FeedBack(e,[],o,t,0,"suggestion");collection.push(s),n.render(s),localStorage.setItem(s.id,JSON.stringify(s))}function renderByStatus(e){return collection.filter(t=>t.status==e)}let init=()=>{n.Handler(createFeedback),console.log(UpdatedCollection),s.sort(collection),t.render()};init();